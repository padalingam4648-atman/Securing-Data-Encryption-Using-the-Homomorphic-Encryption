@echo off
echo ============================================================
echo Malware Analysis Platform - Quick Configuration
echo ============================================================
echo.
echo Current Location: %CD%
echo.

echo ============================================================
echo STEP 1: Configure VirusTotal (Optional)
echo ============================================================
echo.
echo To get a FREE VirusTotal API key:
echo 1. Visit: https://www.virustotal.com/gui/join-us
echo 2. Sign up for free account
echo 3. Go to your profile and copy the API key
echo.
set /p VT_KEY=Enter your VirusTotal API key (or press Enter to skip): 

if not "%VT_KEY%"=="" (
    setx VIRUSTOTAL_API_KEY "%VT_KEY%"
    echo.
    echo ✅ VirusTotal API key saved!
    echo    You need to RESTART the backend for this to take effect.
) else (
    echo.
    echo ⏭️  VirusTotal skipped
)

echo.
echo ============================================================
echo STEP 2: Install YARA (Optional)
echo ============================================================
echo.
echo Attempting to install YARA...
pip install yara-python

if %ERRORLEVEL% EQU 0 (
    echo.
    echo ✅ YARA installed successfully!
) else (
    echo.
    echo ❌ YARA installation failed
    echo.
    echo YARA requires OpenSSL on Windows. To install:
    echo 1. Download OpenSSL from: https://slproweb.com/products/Win32OpenSSL.html
    echo 2. Install "Win64 OpenSSL v3.x.x" (full version, not Light)
    echo 3. Add to PATH: C:\Program Files\OpenSSL-Win64\bin
    echo 4. Restart this script
    echo.
    echo OR: The platform works fine without YARA (optional feature)
)

echo.
echo ============================================================
echo STEP 3: Test Configuration
echo ============================================================
echo.
python test_config.py

echo.
echo ============================================================
echo Next Steps:
echo ============================================================
echo.
if not "%VT_KEY%"=="" (
    echo 1. RESTART the backend to load VirusTotal API key:
    echo    - Close the backend terminal
    echo    - Run: START_MALWARE_PLATFORM.bat
    echo.
)
echo 2. Open the platform: http://localhost:5171/index.html
echo 3. Click "Status" to verify scanner availability
echo.
echo For detailed instructions, see: CONFIGURATION_GUIDE.md
echo.
pause
