# üõ°Ô∏è Malware Analysis Platform

A comprehensive, multi-engine malware analysis platform with hash generation, VirusTotal integration, ClamAV scanning, YARA rule detection, and static analysis.

## ‚ú® Features

### Core Analysis Capabilities
- ‚úÖ **Hash Generation**: MD5, SHA1, SHA256 cryptographic hashes
- ‚úÖ **VirusTotal Integration**: Check against 70+ antivirus engines
- ‚úÖ **ClamAV Scanner**: Local open-source malware detection
- ‚úÖ **YARA Rules**: Pattern-based threat detection
- ‚úÖ **Static Analysis**: String extraction and suspicious keyword detection
- ‚úÖ **Risk Assessment**: Intelligent risk scoring and recommendations

### Security Features
- üîí No file execution - analysis only
- üìä Structured JSON reports
- üéØ Multi-engine detection
- ‚ö° Fast analysis pipeline
- üîç Detailed threat intelligence

## üöÄ Quick Start

### 1. Install Dependencies
```bash
cd malware-platform/backend
pip install -r requirements.txt
```

### 2. Start the Platform
```bash
# Windows
START_MALWARE_PLATFORM.bat

# Linux/macOS
cd backend && python -m app.main
```

### 3. Access the Platform
Open http://localhost:5171/index.html in your browser

## üìã Requirements

### Required
- Python 3.8+
- pip

### Optional (for full functionality)
- **ClamAV**: Local antivirus scanning
- **VirusTotal API Key**: Online threat intelligence (free at virustotal.com)

## üèóÔ∏è Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend  ‚îÇ  (HTML/CSS/JS)
‚îÇ  Port 5171  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ HTTP/REST
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Backend   ‚îÇ  (FastAPI)
‚îÇ  Port 8001  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚ñ∫ Hash Analyzer
       ‚îú‚îÄ‚ñ∫ VirusTotal API
       ‚îú‚îÄ‚ñ∫ ClamAV Scanner
       ‚îú‚îÄ‚ñ∫ YARA Engine
       ‚îú‚îÄ‚ñ∫ Static Analyzer
       ‚îî‚îÄ‚ñ∫ Risk Calculator
```

## üì¶ Project Structure

```
malware-platform/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # FastAPI application
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hash_analyzer.py        # MD5/SHA1/SHA256 generation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ virustotal_checker.py   # VirusTotal API integration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clamav_scanner.py       # ClamAV integration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ yara_scanner.py         # YARA rule engine
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ static_analyzer.py      # String extraction
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ risk_calculator.py      # Risk assessment
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt            # Python dependencies
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îî‚îÄ‚îÄ malware-style.css          # Styling
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îî‚îÄ‚îÄ malware-analysis.js        # Frontend logic
‚îú‚îÄ‚îÄ index.html                      # Main interface
‚îú‚îÄ‚îÄ START_MALWARE_PLATFORM.bat     # Windows startup script
‚îú‚îÄ‚îÄ SETUP_GUIDE.md                 # Detailed setup instructions
‚îî‚îÄ‚îÄ README.md                       # This file
```

## üîß Configuration

### VirusTotal API (Optional)
```bash
# Windows
set VIRUSTOTAL_API_KEY=your_key_here

# Linux/macOS
export VIRUSTOTAL_API_KEY=your_key_here
```

### ClamAV Setup (Optional)
```bash
# Ubuntu/Debian
sudo apt-get install clamav clamav-daemon
sudo systemctl start clamav-daemon

# macOS
brew install clamav
brew services start clamav

# Windows
# Download from clamav.net and install
```

## üìä Analysis Report Structure

```json
{
  "analysis_id": "analysis_20240218_143022",
  "file_info": {
    "filename": "sample.exe",
    "size_bytes": 12345
  },
  "hashes": {
    "md5": "...",
    "sha1": "...",
    "sha256": "..."
  },
  "scan_results": {
    "virustotal": {
      "status": "found",
      "malicious": 45,
      "total": 70
    },
    "clamav": {
      "infected": true,
      "virus_name": "Win.Trojan.Generic"
    },
    "yara": {
      "threat_detected": true,
      "matches": [...]
    },
    "static_analysis": {
      "suspicious_keywords": {...},
      "urls_found": [...],
      "ips_found": [...]
    }
  },
  "risk_assessment": {
    "risk_level": "HIGH",
    "risk_score": 85.5,
    "recommendation": "..."
  }
}
```

## üéØ Use Cases

1. **Malware Research**: Analyze suspicious files safely
2. **Incident Response**: Quick threat assessment
3. **Security Training**: Learn malware analysis techniques
4. **File Verification**: Check file integrity and reputation
5. **Threat Intelligence**: Gather IOCs (Indicators of Compromise)

## ‚ö†Ô∏è Security Warnings

- **Never execute analyzed files** - This platform only analyzes, never runs code
- **Use in isolated environment** - Preferably in a VM or container
- **Keep tools updated** - Regularly update ClamAV definitions
- **Protect API keys** - Never commit keys to version control
- **Validate inputs** - Platform has 50MB file size limit

## üß™ Testing

Test with the EICAR test file (safe antivirus test string):
```bash
echo X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H* > eicar.txt
```

Upload `eicar.txt` to verify scanners are working correctly.

## üìö API Documentation

### Endpoints

#### GET /
Health check

#### GET /api/status
Check scanner availability

#### POST /api/analyze
Analyze uploaded file
- **Content-Type**: multipart/form-data
- **Max Size**: 50MB
- **Returns**: Complete analysis report

## üõ†Ô∏è Troubleshooting

### Backend won't start
- Check Python version: `python --version` (need 3.8+)
- Install dependencies: `pip install -r requirements.txt`
- Check port 8001 is available

### ClamAV not working
- Ensure daemon is running
- Update definitions: `freshclam`
- Platform works without ClamAV (optional)

### VirusTotal not working
- Set API key environment variable
- Check API key is valid
- Platform works without VirusTotal (optional)

## ü§ù Contributing

This is an educational project. Contributions welcome:
- Bug fixes
- New YARA rules
- Additional analysis modules
- Documentation improvements

## üìÑ License

Educational and research purposes only.
Follow responsible disclosure practices.

## üîó Resources

- [VirusTotal API](https://www.virustotal.com/gui/home/upload)
- [ClamAV Documentation](https://docs.clamav.net/)
- [YARA Documentation](https://yara.readthedocs.io/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)

---

**‚ö° Built with FastAPI, Python, and modern web technologies**
