# Malware Analysis Platform - Setup Guide

## Overview
Comprehensive malware analysis platform with multiple scanning engines:
- **Hash Generation**: MD5, SHA1, SHA256
- **VirusTotal Integration**: Check against 70+ antivirus engines
- **ClamAV Scanner**: Local malware detection
- **YARA Rules**: Pattern-based threat detection
- **Static Analysis**: String extraction and suspicious keyword detection

---

## Prerequisites

### Required
- Python 3.8 or higher
- pip (Python package manager)

### Optional (for full functionality)
- **ClamAV**: For local antivirus scanning
- **VirusTotal API Key**: For online threat intelligence

---

## Installation Steps

### 1. Install Python Dependencies

```bash
cd malware-platform/backend
pip install -r requirements.txt
```

### 2. Install ClamAV (Optional but Recommended)

#### Windows:
1. Download ClamAV from: https://www.clamav.net/downloads
2. Install ClamAV
3. Start the ClamAV daemon (clamd)
4. Update virus definitions:
   ```bash
   freshclam
   ```

#### Linux (Ubuntu/Debian):
```bash
sudo apt-get update
sudo apt-get install clamav clamav-daemon
sudo systemctl start clamav-daemon
sudo freshclam
```

#### macOS:
```bash
brew install clamav
brew services start clamav
freshclam
```

### 3. Configure VirusTotal API (Optional)

1. Get a free API key from: https://www.virustotal.com/gui/join-us
2. Set environment variable:

**Windows:**
```cmd
set VIRUSTOTAL_API_KEY=your_api_key_here
```

**Linux/macOS:**
```bash
export VIRUSTOTAL_API_KEY=your_api_key_here
```

Or create a `.env` file in `malware-platform/backend/`:
```
VIRUSTOTAL_API_KEY=your_api_key_here
```

---

## Running the Platform

### Option 1: Use the Startup Script (Recommended)

**Windows:**
```cmd
START_MALWARE_PLATFORM.bat
```

This will:
- Start the backend API on port 8001
- Start the frontend on port 5171
- Open the platform in your browser

### Option 2: Manual Start

**Terminal 1 - Backend:**
```bash
cd malware-platform/backend
python -m app.main
```

**Terminal 2 - Frontend:**
```bash
cd malware-platform
python -m http.server 5171
```

Then open: http://localhost:5171/index.html

---

## Testing the Platform

### 1. Test with EICAR Test File

Create a safe test file (EICAR standard antivirus test file):

```bash
echo X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H* > eicar.txt
```

Upload this file to test malware detection (it's safe, just a test string).

### 2. Test with Regular File

Upload any executable or document to see:
- Hash generation
- String extraction
- Pattern detection

---

## Project Structure

```
malware-platform/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                 # FastAPI application
│   │   ├── hash_analyzer.py        # Hash generation
│   │   ├── virustotal_checker.py   # VirusTotal integration
│   │   ├── clamav_scanner.py       # ClamAV integration
│   │   ├── yara_scanner.py         # YARA rule scanner
│   │   ├── static_analyzer.py      # Static analysis
│   │   └── risk_calculator.py      # Risk assessment
│   └── requirements.txt
├── css/
│   └── malware-style.css
├── js/
│   └── malware-analysis.js
├── index.html
├── START_MALWARE_PLATFORM.bat
└── SETUP_GUIDE.md
```

---

## API Endpoints

### GET /
Health check endpoint

### GET /api/status
Check scanner availability

### POST /api/analyze
Upload and analyze a file

**Request:**
- Method: POST
- Content-Type: multipart/form-data
- Body: file (binary)

**Response:**
```json
{
  "analysis_id": "analysis_20240218_143022",
  "timestamp": "2024-02-18T14:30:22",
  "file_info": {
    "filename": "sample.exe",
    "size_bytes": 12345,
    "size_human": "12.06 KB"
  },
  "hashes": {
    "md5": "...",
    "sha1": "...",
    "sha256": "..."
  },
  "scan_results": {
    "virustotal": {...},
    "clamav": {...},
    "yara": {...},
    "static_analysis": {...}
  },
  "risk_assessment": {
    "risk_level": "HIGH|MEDIUM|LOW",
    "risk_score": 75.5,
    "risk_factors": [...],
    "recommendation": "..."
  }
}
```

---

## Troubleshooting

### ClamAV Not Working
- **Error**: "ClamAV is not running"
- **Solution**: 
  - Ensure ClamAV daemon is running
  - Windows: Check ClamAV service in Services
  - Linux: `sudo systemctl status clamav-daemon`

### VirusTotal Not Working
- **Error**: "VirusTotal API key not configured"
- **Solution**: Set the VIRUSTOTAL_API_KEY environment variable

### YARA Not Working
- **Error**: "YARA scanner not available"
- **Solution**: Reinstall yara-python: `pip install --upgrade yara-python`

### Port Already in Use
- **Error**: "Address already in use"
- **Solution**: 
  - Change port in `app/main.py` (line with `port=8001`)
  - Or kill the process using the port

---

## Security Best Practices

1. **Never execute uploaded files** - Only analyze them
2. **Run in isolated environment** - Use VM or container
3. **Limit file size** - Default max is 50MB
4. **Validate file types** - Check file signatures
5. **Keep ClamAV updated** - Run `freshclam` regularly
6. **Protect API keys** - Never commit to version control
7. **Use HTTPS in production** - Enable SSL/TLS

---

## Features Explained

### 1. Hash Generation
- Generates MD5, SHA1, and SHA256 hashes
- Used for file identification and VirusTotal lookup
- Cryptographic fingerprints of files

### 2. VirusTotal Integration
- Checks file hash against 70+ antivirus engines
- Shows detection rate and threat names
- Requires free API key

### 3. ClamAV Scanner
- Local antivirus scanning
- Open-source malware detection
- Regularly updated virus definitions

### 4. YARA Rules
- Pattern-based detection
- Detects suspicious strings and behaviors
- Custom rules for:
  - Ransomware indicators
  - Keylogger patterns
  - Backdoor signatures
  - Suspicious API calls

### 5. Static Analysis
- Extracts readable strings from binaries
- Detects suspicious keywords (cmd.exe, powershell, etc.)
- Finds URLs and IP addresses
- No code execution required

### 6. Risk Assessment
- Combines all scan results
- Calculates risk score (0-100)
- Provides actionable recommendations
- Color-coded risk levels

---

## Support

For issues or questions:
1. Check the troubleshooting section
2. Review the API documentation
3. Check scanner status at `/api/status`

---

## License

This platform is for educational and research purposes only.
Always follow responsible disclosure practices.
